---
title: 什么是单线程?
date: 2018-12-15
---

### 线程

线程（英语：thread）是操作系统能够进行运算调度的最小单位。它被包含在进程之中，是进程中的实际运作单位。一条线程指的是进程中一个单一顺序的控制流，一个进程中可以并发多个线程，每条线程并行执行不同的任务。

### 线程与进程

对于操作系统来说，一个任务就是一个进程（Process），比如打开一个浏览器就是启动一个浏览器进程，打开一个记事本就启动了一个记事本进程，打开两个记事本就启动了两个记事本进程，打开一个 Word 就启动了一个 Word 进程。

有些进程还不止同时干一件事，比如 Word，它可以同时进行打字、拼写检查、打印等事情。在一个进程内部，要同时干多件事，就需要同时运行多个“子任务”，我们把进程内的这些“子任务”称为线程（Thread）。

由于每个进程至少要干一件事，所以，一个进程至少有一个线程。当然，像 Word 这种复杂的进程可以有多个线程，多个线程可以同时执行，多线程的执行方式和多进程是一样的，也是由操作系统在多个线程之间快速切换，让每个线程都短暂地交替运行，看起来就像同时执行一样。当然，真正地同时执行多线程需要多核 CPU 才可能实现。

我们前面编写的所有的 Python 程序，都是执行单任务的进程，也就是只有一个线程。如果我们要同时执行多个任务怎么办？

### 有两种解决方案：

一种是启动多个进程，每个进程虽然只有一个线程，但多个进程可以一块执行多个任务。
还有一种方法是启动一个进程，在一个进程内启动多个线程，这样，多个线程也可以一块执行多个任务。

### 小结

几乎所有的操作系统都支持同时运行多个任务，一个任务通常就是一个程序，每个运行中的程序就是一个进程。 当一个程序运行时，内部可能包含了多个顺序执行流，每个顺序执行流就是一个线程。

线程是最小的执行单元，而进程由至少一个线程组成。如何调度进程和线程，完全由操作系统决定，程序自己不能决定什么时候执行，执行多长时间。

### 概念总结：

程序：由源代码生成的可执行应用。

进程：当一个程序开始运行时，它就是一个进程，进程包括运行中的程序和程序所使用到的内存和系统资源。而一个进程又是由多个线程所组成的。

线程：线程是程序中的一个执行流，每个线程都有自己的专有寄存器(栈指针、程序计数器等)，但代码区是共享的即不同的线程可以执行同样的函数（一个进程中的线程可以该进程中的共享数据）。

单线程：当一个进程中只有一个线程，称为单线程。所谓单线程即代码一行一行按顺序执行，后面的代码必须等待前面的执行完毕才可以执行

多线程：当一个程序中同时运行多个线程完成不同的工作，称为多线程。

### JS 是单线程的

单线程在某个特定的时刻只有特定的代码能够被执行，并阻塞其它的代码。对于普通的耗时短的代码来说可能没有什么问题，但是对于耗时长的一段代码来说，就会造成卡顿，比如说发起一个网络请求，请求的资源何时返回，这个时间是不可预估的，这种情况下会造成卡顿。所以 js 针对这种情况设计了异步。

异步： 异步的实质是  事件发生促使程序的执行点来回跳转。我们使用 callback 本质上是描述跳转的一种手段。（js 是单线程的，如果要同时处理多个任务，只能让程序的执行点在不同任务之间来回切换，因为执行速度快，所以看起来像是同时进行一样。(这个说法有问题，但有助于理解异步)）

JavaScript 引擎是单线程处理它的任务队列。当异步事件发生时，鼠标点击事件发生、定时器触发事件发生、XMLHttpRequest 完成回调触发等，将他们放入执行队列，等待当前代码执行完成。

javascript 运行机制https://juejin.im/post/59e85eebf265da430d571f89（必看）
javascript 异步和单线程多线程的疑惑https://www.zhihu.com/question/47371217
javascript 单线程和 eventloophttps://www.zhihu.com/question/35905242/answer/129806690
